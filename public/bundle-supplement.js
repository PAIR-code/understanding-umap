var app=function(){"use strict";function t(){}function n(t,n){for(const e in n)t[e]=n[e];return t}function e(t){return t()}function i(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function a(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function s(t,n,e){if(t){const i=l(t,n,e);return t[0](i)}}function l(t,e,i){return t[1]?n({},n(e.$$scope.ctx,t[1](i?i(e):{}))):e.$$scope.ctx}function c(t,e,i,r){return t[1]?n({},n(e.$$scope.changed||{},t[1](r?r(i):{}))):e.$$scope.changed||{}}function u(t,n){t.appendChild(n)}function h(t,n,e){t.insertBefore(n,e||null)}function f(t){t.parentNode.removeChild(t)}function p(t){return document.createElement(t)}function d(t){return document.createTextNode(t)}function g(){return d(" ")}function m(t,n,e,i){return t.addEventListener(n,e,i),()=>t.removeEventListener(n,e,i)}function b(t,n,e){null==e?t.removeAttribute(n):t.setAttribute(n,e)}function y(t,n){n=""+n,t.data!==n&&(t.data=n)}function v(t,n){(null!=n||t.value)&&(t.value=n)}function w(t,n,e,i){t.style.setProperty(n,e,i?"important":"")}let $;function x(t){$=t}function M(t){(function(){if(!$)throw new Error("Function called outside component initialization");return $})().$$.after_update.push(t)}const k=[],N=[],_=[],A=[],j=Promise.resolve();let P=!1;function E(t){_.push(t)}function S(t){A.push(t)}function C(){const t=new Set;do{for(;k.length;){const t=k.shift();x(t),T(t.$$)}for(;N.length;)N.pop()();for(let n=0;n<_.length;n+=1){const e=_[n];t.has(e)||(e(),t.add(e))}_.length=0}while(k.length);for(;A.length;)A.pop()();P=!1}function T(t){t.fragment&&(t.update(t.dirty),r(t.before_update),t.fragment.p(t.dirty,t.ctx),t.dirty=null,t.after_update.forEach(E))}const z=new Set;let q,U;function F(t,n){t&&t.i&&(z.delete(t),t.i(n))}function R(t,n,e,i){if(t&&t.o){if(z.has(t))return;z.add(t),q.c.push(()=>{z.delete(t),i&&(e&&t.d(1),i())}),t.o(n)}}function I(t,n,e){-1!==t.$$.props.indexOf(n)&&(t.$$.bound[n]=e,e(t.$$.ctx[n]))}function H(t,n,i){const{fragment:a,on_mount:s,on_destroy:l,after_update:c}=t.$$;a.m(n,i),E(()=>{const n=s.map(e).filter(o);l?l.push(...n):r(n),t.$$.on_mount=[]}),c.forEach(E)}function L(t,n){t.$$.fragment&&(r(t.$$.on_destroy),t.$$.fragment.d(n),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={})}function O(t,n){t.$$.dirty||(k.push(t),P||(P=!0,j.then(C)),t.$$.dirty=i()),t.$$.dirty[n]=!0}function D(n,e,o,a,s,l){const c=$;x(n);const u=e.props||{},h=n.$$={fragment:null,ctx:null,props:l,update:t,not_equal:s,bound:i(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(c?c.$$.context:[]),callbacks:i(),dirty:null};let f=!1;var p;h.ctx=o?o(n,u,(t,e,i=e)=>(h.ctx&&s(h.ctx[t],h.ctx[t]=i)&&(h.bound[t]&&h.bound[t](i),f&&O(n,t)),e)):u,h.update(),f=!0,r(h.before_update),h.fragment=a(h.ctx),e.target&&(e.hydrate?h.fragment.l((p=e.target,Array.from(p.childNodes))):h.fragment.c(),e.intro&&F(n.$$.fragment),H(n,e.target,e.anchor),C()),x(c)}"undefined"!=typeof HTMLElement&&(U=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){for(const t in this.$$.slotted)this.appendChild(this.$$.slotted[t])}attributeChangedCallback(t,n,e){this[t]=e}$destroy(){L(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(){}});class B{$destroy(){L(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(){}}const G=()=>({}),W=()=>({});function J(t){var n,e,i,r,o;const a=t.$$slots.default,d=s(a,t,null),m=t.$$slots.caption,y=s(m,t,W);return{c(){n=p("figure"),e=p("div"),d&&d.c(),i=g(),r=p("caption"),y&&y.c(),b(e,"class","figure-container svelte-1l13q0g"),b(r,"class","svelte-1l13q0g"),b(n,"class","svelte-1l13q0g")},l(t){d&&d.l(div_nodes),y&&y.l(caption_nodes)},m(t,a){h(t,n,a),u(n,e),d&&d.m(e,null),u(n,i),u(n,r),y&&y.m(r,null),o=!0},p(t,n){d&&d.p&&t.$$scope&&d.p(c(a,n,t,null),l(a,n,null)),y&&y.p&&t.$$scope&&y.p(c(m,n,t,G),l(m,n,W))},i(t){o||(F(d,t),F(y,t),o=!0)},o(t){R(d,t),R(y,t),o=!1},d(t){t&&f(n),d&&d.d(t),y&&y.d(t)}}}function V(t,n,e){let{$$slots:i={},$$scope:r}=n;return t.$set=(t=>{"$$scope"in t&&e("$$scope",r=t.$$scope)}),{$$slots:i,$$scope:r}}class X extends B{constructor(t){super(),D(this,t,V,J,a,[])}}function Y(n){var e;return{c(){b(e=p("div"),"class","spacer svelte-6euh3r"),w(e,"height",n.height+"px")},m(t,n){h(t,e,n)},p(t,n){t.height&&w(e,"height",n.height+"px")},i:t,o:t,d(t){t&&f(e)}}}function Z(t,n,e){let{height:i=50}=n;return t.$set=(t=>{"height"in t&&e("height",i=t.height)}),{height:i}}class K extends B{constructor(t){super(),D(this,t,Z,Y,a,["height"])}}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var Q,tt=(function(t,n){!function(t){function n(t,n,e){this.obj=t,this.left=null,this.right=null,this.parent=e,this.dimension=n}function e(t){this.content=[],this.scoreFunction=t}e.prototype={push:function(t){this.content.push(t),this.bubbleUp(this.content.length-1)},pop:function(){var t=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.sinkDown(0)),t},peek:function(){return this.content[0]},remove:function(t){for(var n=this.content.length,e=0;e<n;e++)if(this.content[e]==t){var i=this.content.pop();return void(e!=n-1&&(this.content[e]=i,this.scoreFunction(i)<this.scoreFunction(t)?this.bubbleUp(e):this.sinkDown(e)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(t){for(var n=this.content[t];t>0;){var e=Math.floor((t+1)/2)-1,i=this.content[e];if(!(this.scoreFunction(n)<this.scoreFunction(i)))break;this.content[e]=n,this.content[t]=i,t=e}},sinkDown:function(t){for(var n=this.content.length,e=this.content[t],i=this.scoreFunction(e);;){var r=2*(t+1),o=r-1,a=null;if(o<n){var s=this.content[o],l=this.scoreFunction(s);l<i&&(a=o)}if(r<n){var c=this.content[r];this.scoreFunction(c)<(null==a?i:l)&&(a=r)}if(null==a)break;this.content[t]=this.content[a],this.content[a]=e,t=a}}},t.kdTree=function(t,i,r){var o=this;Array.isArray(t)?this.root=function t(e,i,o){var a,s,l=i%r.length;return 0===e.length?null:1===e.length?new n(e[0],l,o):(e.sort(function(t,n){return t[r[l]]-n[r[l]]}),a=Math.floor(e.length/2),(s=new n(e[a],l,o)).left=t(e.slice(0,a),i+1,s),s.right=t(e.slice(a+1),i+1,s),s)}(t,0,null):function(t){o.root=t,function t(n){n.left&&(n.left.parent=n,t(n.left)),n.right&&(n.right.parent=n,t(n.right))}(o.root)}(t),this.toJSON=function(t){t||(t=this.root);var e=new n(t.obj,t.dimension,null);return t.left&&(e.left=o.toJSON(t.left)),t.right&&(e.right=o.toJSON(t.right)),e},this.insert=function(t){var e,i,o=function n(e,i){if(null===e)return i;var o=r[e.dimension];return t[o]<e.obj[o]?n(e.left,e):n(e.right,e)}(this.root,null);null!==o?(e=new n(t,(o.dimension+1)%r.length,o),i=r[o.dimension],t[i]<o.obj[i]?o.left=e:o.right=e):this.root=new n(t,0,null)},this.remove=function(t){var n;null!==(n=function n(e){if(null===e)return null;if(e.obj===t)return e;var i=r[e.dimension];return t[i]<e.obj[i]?n(e.left):n(e.right)}(o.root))&&function t(n){function e(t,n){var i,o,a,s,l;return null===t?null:(i=r[n],t.dimension===n?null!==t.left?e(t.left,n):t:(o=t.obj[i],a=e(t.left,n),s=e(t.right,n),l=t,null!==a&&a.obj[i]<o&&(l=a),null!==s&&s.obj[i]<l.obj[i]&&(l=s),l))}var i,a,s;if(null===n.left&&null===n.right)return null===n.parent?void(o.root=null):(s=r[n.parent.dimension],void(n.obj[s]<n.parent.obj[s]?n.parent.left=null:n.parent.right=null));null!==n.right?(a=(i=e(n.right,n.dimension)).obj,t(i),n.obj=a):(a=(i=e(n.left,n.dimension)).obj,t(i),n.right=n.left,n.left=null,n.obj=a)}(n)},this.nearest=function(t,n,a){var s,l,c;if(c=new e(function(t){return-t[1]}),a)for(s=0;s<n;s+=1)c.push([null,a]);for(o.root&&function e(o){function a(t,e){c.push([t,e]),c.size()>n&&c.pop()}var s,l,u,h,f=r[o.dimension],p=i(t,o.obj),d={};for(h=0;h<r.length;h+=1)h===o.dimension?d[r[h]]=t[r[h]]:d[r[h]]=o.obj[r[h]];l=i(d,o.obj),null!==o.right||null!==o.left?(e(s=null===o.right?o.left:null===o.left?o.right:t[f]<o.obj[f]?o.left:o.right),(c.size()<n||p<c.peek()[1])&&a(o,p),(c.size()<n||Math.abs(l)<c.peek()[1])&&null!==(u=s===o.left?o.right:o.left)&&e(u)):(c.size()<n||p<c.peek()[1])&&a(o,p)}(o.root),l=[],s=0;s<Math.min(n,c.content.length);s+=1)c.content[s][0]&&l.push([c.content[s][0].obj,c.content[s][1]]);return l},this.balanceFactor=function(){return function t(n){return null===n?0:Math.max(t(n.left),t(n.right))+1}(o.root)/(Math.log(function t(n){return null===n?0:t(n.left)+t(n.right)+1}(o.root))/Math.log(2))}},t.BinaryHeap=e}(n)}(Q={exports:{}},Q.exports),Q.exports);function nt(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}var et,it,rt=(1===(et=nt).length&&(it=et,et=function(t,n){return nt(it(t),n)}),{left:function(t,n,e,i){for(null==e&&(e=0),null==i&&(i=t.length);e<i;){var r=e+i>>>1;et(t[r],n)<0?e=r+1:i=r}return e},right:function(t,n,e,i){for(null==e&&(e=0),null==i&&(i=t.length);e<i;){var r=e+i>>>1;et(t[r],n)>0?i=r:e=r+1}return e}}).right,ot=Math.sqrt(50),at=Math.sqrt(10),st=Math.sqrt(2);function lt(t,n,e){var i=(n-t)/Math.max(0,e),r=Math.floor(Math.log(i)/Math.LN10),o=i/Math.pow(10,r);return r>=0?(o>=ot?10:o>=at?5:o>=st?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(o>=ot?10:o>=at?5:o>=st?2:1)}function ct(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function ut(t,n){var e=Object.create(t.prototype);for(var i in n)e[i]=n[i];return e}function ht(){}var ft="\\s*([+-]?\\d+)\\s*",pt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",dt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gt=/^#([0-9a-f]{3})$/,mt=/^#([0-9a-f]{6})$/,bt=new RegExp("^rgb\\("+[ft,ft,ft]+"\\)$"),yt=new RegExp("^rgb\\("+[dt,dt,dt]+"\\)$"),vt=new RegExp("^rgba\\("+[ft,ft,ft,pt]+"\\)$"),wt=new RegExp("^rgba\\("+[dt,dt,dt,pt]+"\\)$"),$t=new RegExp("^hsl\\("+[pt,dt,dt]+"\\)$"),xt=new RegExp("^hsla\\("+[pt,dt,dt,pt]+"\\)$"),Mt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function kt(){return this.rgb().formatHex()}function Nt(){return this.rgb().formatRgb()}function _t(t){var n;return t=(t+"").trim().toLowerCase(),(n=gt.exec(t))?new St((n=parseInt(n[1],16))>>8&15|n>>4&240,n>>4&15|240&n,(15&n)<<4|15&n,1):(n=mt.exec(t))?At(parseInt(n[1],16)):(n=bt.exec(t))?new St(n[1],n[2],n[3],1):(n=yt.exec(t))?new St(255*n[1]/100,255*n[2]/100,255*n[3]/100,1):(n=vt.exec(t))?jt(n[1],n[2],n[3],n[4]):(n=wt.exec(t))?jt(255*n[1]/100,255*n[2]/100,255*n[3]/100,n[4]):(n=$t.exec(t))?qt(n[1],n[2]/100,n[3]/100,1):(n=xt.exec(t))?qt(n[1],n[2]/100,n[3]/100,n[4]):Mt.hasOwnProperty(t)?At(Mt[t]):"transparent"===t?new St(NaN,NaN,NaN,0):null}function At(t){return new St(t>>16&255,t>>8&255,255&t,1)}function jt(t,n,e,i){return i<=0&&(t=n=e=NaN),new St(t,n,e,i)}function Pt(t){return t instanceof ht||(t=_t(t)),t?new St((t=t.rgb()).r,t.g,t.b,t.opacity):new St}function Et(t,n,e,i){return 1===arguments.length?Pt(t):new St(t,n,e,null==i?1:i)}function St(t,n,e,i){this.r=+t,this.g=+n,this.b=+e,this.opacity=+i}function Ct(){return"#"+zt(this.r)+zt(this.g)+zt(this.b)}function Tt(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function zt(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function qt(t,n,e,i){return i<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new Ft(t,n,e,i)}function Ut(t){if(t instanceof Ft)return new Ft(t.h,t.s,t.l,t.opacity);if(t instanceof ht||(t=_t(t)),!t)return new Ft;if(t instanceof Ft)return t;var n=(t=t.rgb()).r/255,e=t.g/255,i=t.b/255,r=Math.min(n,e,i),o=Math.max(n,e,i),a=NaN,s=o-r,l=(o+r)/2;return s?(a=n===o?(e-i)/s+6*(e<i):e===o?(i-n)/s+2:(n-e)/s+4,s/=l<.5?o+r:2-o-r,a*=60):s=l>0&&l<1?0:a,new Ft(a,s,l,t.opacity)}function Ft(t,n,e,i){this.h=+t,this.s=+n,this.l=+e,this.opacity=+i}function Rt(t,n,e){return 255*(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)}ct(ht,_t,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:kt,formatHex:kt,formatHsl:function(){return Ut(this).formatHsl()},formatRgb:Nt,toString:Nt}),ct(St,Et,ut(ht,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new St(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new St(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ct,formatHex:Ct,formatRgb:Tt,toString:Tt})),ct(Ft,function(t,n,e,i){return 1===arguments.length?Ut(t):new Ft(t,n,e,null==i?1:i)},ut(ht,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Ft(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ft(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,i=e+(e<.5?e:1-e)*n,r=2*e-i;return new St(Rt(t>=240?t-240:t+120,r,i),Rt(t,r,i),Rt(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var It=Math.PI/180,Ht=180/Math.PI,Lt=.96422,Ot=1,Dt=.82521,Bt=4/29,Gt=6/29,Wt=3*Gt*Gt,Jt=Gt*Gt*Gt;function Vt(t){if(t instanceof Xt)return new Xt(t.l,t.a,t.b,t.opacity);if(t instanceof tn)return nn(t);t instanceof St||(t=Pt(t));var n,e,i=Qt(t.r),r=Qt(t.g),o=Qt(t.b),a=Yt((.2225045*i+.7168786*r+.0606169*o)/Ot);return i===r&&r===o?n=e=a:(n=Yt((.4360747*i+.3850649*r+.1430804*o)/Lt),e=Yt((.0139322*i+.0971045*r+.7141733*o)/Dt)),new Xt(116*a-16,500*(n-a),200*(a-e),t.opacity)}function Xt(t,n,e,i){this.l=+t,this.a=+n,this.b=+e,this.opacity=+i}function Yt(t){return t>Jt?Math.pow(t,1/3):t/Wt+Bt}function Zt(t){return t>Gt?t*t*t:Wt*(t-Bt)}function Kt(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Qt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function tn(t,n,e,i){this.h=+t,this.c=+n,this.l=+e,this.opacity=+i}function nn(t){if(isNaN(t.h))return new Xt(t.l,0,0,t.opacity);var n=t.h*It;return new Xt(t.l,Math.cos(n)*t.c,Math.sin(n)*t.c,t.opacity)}ct(Xt,function(t,n,e,i){return 1===arguments.length?Vt(t):new Xt(t,n,e,null==i?1:i)},ut(ht,{brighter:function(t){return new Xt(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new Xt(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,n=isNaN(this.a)?t:t+this.a/500,e=isNaN(this.b)?t:t-this.b/200;return new St(Kt(3.1338561*(n=Lt*Zt(n))-1.6168667*(t=Ot*Zt(t))-.4906146*(e=Dt*Zt(e))),Kt(-.9787684*n+1.9161415*t+.033454*e),Kt(.0719453*n-.2289914*t+1.4052427*e),this.opacity)}})),ct(tn,function(t,n,e,i){return 1===arguments.length?function(t){if(t instanceof tn)return new tn(t.h,t.c,t.l,t.opacity);if(t instanceof Xt||(t=Vt(t)),0===t.a&&0===t.b)return new tn(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var n=Math.atan2(t.b,t.a)*Ht;return new tn(n<0?n+360:n,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new tn(t,n,e,null==i?1:i)},ut(ht,{brighter:function(t){return new tn(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new tn(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return nn(this).rgb()}}));var en=-.14861,rn=1.78277,on=-.29227,an=-.90649,sn=1.97294,ln=sn*an,cn=sn*rn,un=rn*on-an*en;function hn(t,n,e,i){this.h=+t,this.s=+n,this.l=+e,this.opacity=+i}function fn(t){return function(){return t}}function pn(t){return 1==(t=+t)?dn:function(n,e){return e-n?function(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(i){return Math.pow(t+i*n,e)}}(n,e,t):fn(isNaN(n)?e:n)}}function dn(t,n){var e=n-t;return e?function(t,n){return function(e){return t+e*n}}(t,e):fn(isNaN(t)?n:t)}ct(hn,function(t,n,e,i){return 1===arguments.length?function(t){if(t instanceof hn)return new hn(t.h,t.s,t.l,t.opacity);t instanceof St||(t=Pt(t));var n=t.r/255,e=t.g/255,i=t.b/255,r=(un*i+ln*n-cn*e)/(un+ln-cn),o=i-r,a=(sn*(e-r)-on*o)/an,s=Math.sqrt(a*a+o*o)/(sn*r*(1-r)),l=s?Math.atan2(a,o)*Ht-120:NaN;return new hn(l<0?l+360:l,s,r,t.opacity)}(t):new hn(t,n,e,null==i?1:i)},ut(ht,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new hn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new hn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*It,n=+this.l,e=isNaN(this.s)?0:this.s*n*(1-n),i=Math.cos(t),r=Math.sin(t);return new St(255*(n+e*(en*i+rn*r)),255*(n+e*(on*i+an*r)),255*(n+e*(sn*i)),this.opacity)}}));var gn=function t(n){var e=pn(n);function i(t,n){var i=e((t=Et(t)).r,(n=Et(n)).r),r=e(t.g,n.g),o=e(t.b,n.b),a=dn(t.opacity,n.opacity);return function(n){return t.r=i(n),t.g=r(n),t.b=o(n),t.opacity=a(n),t+""}}return i.gamma=t,i}(1);function mn(t,n){return n-=t=+t,function(e){return t+n*e}}var bn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yn=new RegExp(bn.source,"g");function vn(t,n){var e,i=typeof n;return null==n||"boolean"===i?fn(n):("number"===i?mn:"string"===i?(e=_t(n))?(n=e,gn):function(t,n){var e,i,r,o=bn.lastIndex=yn.lastIndex=0,a=-1,s=[],l=[];for(t+="",n+="";(e=bn.exec(t))&&(i=yn.exec(n));)(r=i.index)>o&&(r=n.slice(o,r),s[a]?s[a]+=r:s[++a]=r),(e=e[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:mn(e,i)})),o=yn.lastIndex;return o<n.length&&(r=n.slice(o),s[a]?s[a]+=r:s[++a]=r),s.length<2?l[0]?function(t){return function(n){return t(n)+""}}(l[0].x):function(t){return function(){return t}}(n):(n=l.length,function(t){for(var e,i=0;i<n;++i)s[(e=l[i]).i]=e.x(t);return s.join("")})}:n instanceof _t?gn:n instanceof Date?function(t,n){var e=new Date;return n-=t=+t,function(i){return e.setTime(t+n*i),e}}:Array.isArray(n)?function(t,n){var e,i=n?n.length:0,r=t?Math.min(i,t.length):0,o=new Array(r),a=new Array(i);for(e=0;e<r;++e)o[e]=vn(t[e],n[e]);for(;e<i;++e)a[e]=n[e];return function(t){for(e=0;e<r;++e)a[e]=o[e](t);return a}}:"function"!=typeof n.valueOf&&"function"!=typeof n.toString||isNaN(n)?function(t,n){var e,i={},r={};for(e in null!==t&&"object"==typeof t||(t={}),null!==n&&"object"==typeof n||(n={}),n)e in t?i[e]=vn(t[e],n[e]):r[e]=n[e];return function(t){for(e in i)r[e]=i[e](t);return r}}:mn)(t,n)}function wn(t,n){return n-=t=+t,function(e){return Math.round(t+n*e)}}function $n(t){return+t}var xn=[0,1];function Mn(t){return t}function kn(t,n){return(n-=t=+t)?function(e){return(e-t)/n}:(e=isNaN(n)?NaN:.5,function(){return e});var e}function Nn(t,n,e){var i=t[0],r=t[1],o=n[0],a=n[1];return r<i?(i=kn(r,i),o=e(a,o)):(i=kn(i,r),o=e(o,a)),function(t){return o(i(t))}}function _n(t,n,e){var i=Math.min(t.length,n.length)-1,r=new Array(i),o=new Array(i),a=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),n=n.slice().reverse());++a<i;)r[a]=kn(t[a],t[a+1]),o[a]=e(n[a],n[a+1]);return function(n){var e=rt(t,n,1,i)-1;return o[e](r[e](n))}}function An(){var t,n,e,i,r,o,a=xn,s=xn,l=vn,c=Mn;function u(){var t,n,e,l=Math.min(a.length,s.length);return c!==Mn&&(t=a[0],n=a[l-1],t>n&&(e=t,t=n,n=e),c=function(e){return Math.max(t,Math.min(n,e))}),i=l>2?_n:Nn,r=o=null,h}function h(n){return isNaN(n=+n)?e:(r||(r=i(a.map(t),s,l)))(t(c(n)))}return h.invert=function(e){return c(n((o||(o=i(s,a.map(t),mn)))(e)))},h.domain=function(t){return arguments.length?(a=Array.from(t,$n),u()):a.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),u()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),l=wn,u()},h.clamp=function(t){return arguments.length?(c=!!t||Mn,u()):c!==Mn},h.interpolate=function(t){return arguments.length?(l=t,u()):l},h.unknown=function(t){return arguments.length?(e=t,h):e},function(e,i){return t=e,n=i,u()}}function jn(t,n){if((e=(t=n?t.toExponential(n-1):t.toExponential()).indexOf("e"))<0)return null;var e,i=t.slice(0,e);return[i.length>1?i[0]+i.slice(2):i,+t.slice(e+1)]}function Pn(t){return(t=jn(Math.abs(t)))?t[1]:NaN}var En,Sn=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Cn(t){if(!(n=Sn.exec(t)))throw new Error("invalid format: "+t);var n;return new Tn({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}function Tn(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function zn(t,n){var e=jn(t,n);if(!e)return t+"";var i=e[0],r=e[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}Cn.prototype=Tn.prototype,Tn.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var qn={"%":function(t,n){return(100*t).toFixed(n)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,n){return t.toExponential(n)},f:function(t,n){return t.toFixed(n)},g:function(t,n){return t.toPrecision(n)},o:function(t){return Math.round(t).toString(8)},p:function(t,n){return zn(100*t,n)},r:zn,s:function(t,n){var e=jn(t,n);if(!e)return t+"";var i=e[0],r=e[1],o=r-(En=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,a=i.length;return o===a?i:o>a?i+new Array(o-a+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+jn(t,Math.max(0,n+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function Un(t){return t}var Fn,Rn,In,Hn=Array.prototype.map,Ln=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function On(t){var n,e,i=void 0===t.grouping||void 0===t.thousands?Un:(n=Hn.call(t.grouping,Number),e=t.thousands+"",function(t,i){for(var r=t.length,o=[],a=0,s=n[0],l=0;r>0&&s>0&&(l+s+1>i&&(s=Math.max(1,i-l)),o.push(t.substring(r-=s,r+s)),!((l+=s+1)>i));)s=n[a=(a+1)%n.length];return o.reverse().join(e)}),r=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Un:function(t){return function(n){return n.replace(/[0-9]/g,function(n){return t[+n]})}}(Hn.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"-":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t){var n=(t=Cn(t)).fill,e=t.align,h=t.sign,f=t.symbol,p=t.zero,d=t.width,g=t.comma,m=t.precision,b=t.trim,y=t.type;"n"===y?(g=!0,y="g"):qn[y]||(void 0===m&&(m=12),b=!0,y="g"),(p||"0"===n&&"="===e)&&(p=!0,n="0",e="=");var v="$"===f?r:"#"===f&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",w="$"===f?o:/[%p]/.test(y)?l:"",$=qn[y],x=/[defgprs%]/.test(y);function M(t){var r,o,l,f=v,M=w;if("c"===y)M=$(t)+M,t="";else{var k=(t=+t)<0;if(t=isNaN(t)?u:$(Math.abs(t),m),b&&(t=function(t){t:for(var n,e=t.length,i=1,r=-1;i<e;++i)switch(t[i]){case".":r=n=i;break;case"0":0===r&&(r=i),n=i;break;default:if(r>0){if(!+t[i])break t;r=0}}return r>0?t.slice(0,r)+t.slice(n+1):t}(t)),k&&0==+t&&(k=!1),f=(k?"("===h?h:c:"-"===h||"("===h?"":h)+f,M=("s"===y?Ln[8+En/3]:"")+M+(k&&"("===h?")":""),x)for(r=-1,o=t.length;++r<o;)if(48>(l=t.charCodeAt(r))||l>57){M=(46===l?a+t.slice(r+1):t.slice(r))+M,t=t.slice(0,r);break}}g&&!p&&(t=i(t,1/0));var N=f.length+t.length+M.length,_=N<d?new Array(d-N+1).join(n):"";switch(g&&p&&(t=i(_+t,_.length?d-M.length:1/0),_=""),e){case"<":t=f+t+M+_;break;case"=":t=f+_+t+M;break;case"^":t=_.slice(0,N=_.length>>1)+f+t+M+_.slice(N);break;default:t=_+f+t+M}return s(t)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),M.toString=function(){return t+""},M}return{format:h,formatPrefix:function(t,n){var e=h(((t=Cn(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(Pn(n)/3))),r=Math.pow(10,-i),o=Ln[8+i/3];return function(t){return e(r*t)+o}}}}function Dn(t,n,e,i){var r,o=function(t,n,e){var i=Math.abs(n-t)/Math.max(0,e),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=ot?r*=10:o>=at?r*=5:o>=st&&(r*=2),n<t?-r:r}(t,n,e);switch((i=Cn(null==i?",f":i)).type){case"s":var a=Math.max(Math.abs(t),Math.abs(n));return null!=i.precision||isNaN(r=function(t,n){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Pn(n)/3)))-Pn(Math.abs(t)))}(o,a))||(i.precision=r),In(i,a);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(t,n){return t=Math.abs(t),n=Math.abs(n)-t,Math.max(0,Pn(n)-Pn(t))+1}(o,Math.max(Math.abs(t),Math.abs(n))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(t){return Math.max(0,-Pn(Math.abs(t)))}(o))||(i.precision=r-2*("%"===i.type))}return Rn(i)}function Bn(t){var n=t.domain;return t.ticks=function(t){var e=n();return function(t,n,e){var i,r,o,a,s=-1;if(e=+e,(t=+t)==(n=+n)&&e>0)return[t];if((i=n<t)&&(r=t,t=n,n=r),0===(a=lt(t,n,e))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),n=Math.floor(n/a),o=new Array(r=Math.ceil(n-t+1));++s<r;)o[s]=(t+s)*a;else for(t=Math.floor(t*a),n=Math.ceil(n*a),o=new Array(r=Math.ceil(t-n+1));++s<r;)o[s]=(t-s)/a;return i&&o.reverse(),o}(e[0],e[e.length-1],null==t?10:t)},t.tickFormat=function(t,e){var i=n();return Dn(i[0],i[i.length-1],null==t?10:t,e)},t.nice=function(e){null==e&&(e=10);var i,r=n(),o=0,a=r.length-1,s=r[o],l=r[a];return l<s&&(i=s,s=l,l=i,i=o,o=a,a=i),(i=lt(s,l,e))>0?i=lt(s=Math.floor(s/i)*i,l=Math.ceil(l/i)*i,e):i<0&&(i=lt(s=Math.ceil(s*i)/i,l=Math.floor(l*i)/i,e)),i>0?(r[o]=Math.floor(s/i)*i,r[a]=Math.ceil(l/i)*i,n(r)):i<0&&(r[o]=Math.ceil(s*i)/i,r[a]=Math.floor(l*i)/i,n(r)),t},t}function Gn(){var t=An()(Mn,Mn);return t.copy=function(){return n=t,Gn().domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown());var n},function(t,n){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(n).domain(t)}return this}.apply(t,arguments),Bn(t)}Fn=On({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),Rn=Fn.format,In=Fn.formatPrefix;const Wn=new class{constructor(t){this._seed=t%2147483647,this._seed<=0&&(this._seed+=2147483646)}next(){return this._seed=16807*this._seed%2147483647}nextFloat(t,n){return(this.next()-1)/2147483646}}(112),Jn=(t,n,e=0)=>Math.max(Math.min(t,n),e),Vn=t=>Math.floor(t*Wn.nextFloat()),Xn=(t,n,e)=>{let i=Vn(t),r=Math.sin(i/t*6*Math.PI)*n/4+n/2;return r+=Vn(n/5)*(Wn.nextFloat()>.5?1:-1),{x:Jn(i,t-e,e),y:Jn(r,n-e,e)}};function Yn(t,n,e=5){const{width:i,height:r}=n,o=[];for(let n=0;n<t;n++){const t=Xn(i,r,e);o.push({...t,index:n})}return o}function Zn(n){var e,i;return{c(){b(e=p("input"),"type","range"),b(e,"min",n.min),b(e,"max",n.max),b(e,"step",n.step),b(e,"class","svelte-fa559t"),i=[m(e,"change",n.input_change_input_handler),m(e,"input",n.input_change_input_handler),m(e,"change",n.onSliderChange)]},m(t,i){h(t,e,i),v(e,n.value)},p(t,n){t.value&&v(e,n.value),t.min&&b(e,"min",n.min),t.max&&b(e,"max",n.max),t.step&&b(e,"step",n.step)},i:t,o:t,d(t){t&&f(e),r(i)}}}function Kn(t,n,e){let{value:i,min:r=0,max:o=100,step:a=1,onChange:s=(()=>{})}=n;return t.$set=(t=>{"value"in t&&e("value",i=t.value),"min"in t&&e("min",r=t.min),"max"in t&&e("max",o=t.max),"step"in t&&e("step",a=t.step),"onChange"in t&&e("onChange",s=t.onChange)}),{value:i,min:r,max:o,step:a,onChange:s,onSliderChange:t=>{s(t.target.value)},input_change_input_handler:function(){i=function(t){return""===t?void 0:+t}(this.value),e("value",i)}}}class Qn extends B{constructor(t){super(),D(this,t,Kn,Zn,a,["value","min","max","step","onChange"])}}function te(t){var n,e,i,r,o,a,s,l,c,v,w,$,x,M,k,_,A,j,P,E,C;function T(n){t.slider0_value_binding.call(null,n),v=!0,S(()=>v=!1)}let z={min:0,max:100,step:1};void 0!==t.extent&&(z.value=t.extent);var q=new Qn({props:z});function U(n){t.slider1_value_binding.call(null,n),A=!0,S(()=>A=!1)}N.push(()=>I(q,"value",T));let O={min:2,max:10,step:1};void 0!==t.nNearest&&(O.value=t.nNearest);var D=new Qn({props:O});return N.push(()=>I(D,"value",U)),{c(){n=p("div"),e=p("canvas"),i=g(),r=p("div"),o=p("label"),a=d("extent: "),s=d(t.extent),l=d("%"),c=g(),q.$$.fragment.c(),w=g(),$=p("div"),x=p("label"),M=d("n_nearest: "),k=d(t.nNearest),_=g(),D.$$.fragment.c(),j=g(),(P=p("div")).innerHTML='<i class="material-icons">refresh</i>',b(e,"width",ee),b(e,"height",ie),b(e,"class","svelte-rm2utp"),b(o,"class","svelte-rm2utp"),b(r,"class","controls svelte-rm2utp"),b(x,"class","svelte-rm2utp"),b($,"class","controls svelte-rm2utp"),b(P,"class","refresh svelte-rm2utp"),b(n,"class","container svelte-rm2utp"),C=m(P,"click",t.refreshPoints)},m(f,p){h(f,n,p),u(n,e),t.canvas_1_binding(e),u(n,i),u(n,r),u(r,o),u(o,a),u(o,s),u(o,l),u(r,c),H(q,r,null),u(n,w),u(n,$),u($,x),u(x,M),u(x,k),u($,_),H(D,$,null),u(n,j),u(n,P),E=!0},p(t,n){E&&!t.extent||y(s,n.extent);var e={};!v&&t.extent&&(e.value=n.extent),q.$set(e),E&&!t.nNearest||y(k,n.nNearest);var i={};!A&&t.nNearest&&(i.value=n.nNearest),D.$set(i)},i(t){E||(F(q.$$.fragment,t),F(D.$$.fragment,t),E=!0)},o(t){R(q.$$.fragment,t),R(D.$$.fragment,t),E=!1},d(e){e&&f(n),t.canvas_1_binding(null),L(q),L(D),C()}}}const ne=9,ee=2048,ie=1024,re=100;function oe(t,n,e){const i=[[44,123,182],[0,166,202],[0,204,188],[144,235,157]],r=Gn().range(i);let o,a=0,s=5,l=5;r.domain(i.map((t,n)=>n/(i.length-1)*ee));let c=Yn(re,{width:ee,height:ie},ne);let u,h,f,p,d;const g=()=>{const t=new tt.kdTree([...c],(t,n)=>Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2)),["x","y"]);u=c.map(n=>{return t.nearest(n,l+1).sort((t,n)=>t[1]-n[1]).slice(1,l+1).map(t=>{const n=t[0],{x:e,y:i,index:r}=n;return{point:{x:e,y:i},index:r,distance:t[1]}})}),h=u.map(t=>t.map(t=>t.distance)),f=h.map(t=>t[t.length-1]),p=c.map((t,n)=>{const e=f[n],i=h[n][0],r=u[n][0].index,o=f[r],a=h[r][0];if(i>a){const t=u[r][0].index;return i-o*(a/(o+f[t]))}return i/(e+o)*e}),d=c.map(t=>r(t.x))},m=()=>{s!==l&&(g(),s=l);const t=o.getContext("2d"),n=a/100;t.clearRect(0,0,ee,ie),c.forEach((n,e)=>{const{x:i,y:r}=n;t.beginPath(),t.arc(i,r,ne,0,2*Math.PI);const[o,a,s]=d[e];t.fillStyle=`rgba(${o},${a},${s},1)`,t.fill()}),c.forEach((e,i)=>{const{x:r,y:o}=e,a=p[i],s=f[i],l=s*n,[c,u,h]=d[i],g=`rgba(${c},${u},${h},0.2)`,m=`rgba(${c},${u},${h},0.0)`,b=t.createRadialGradient(r,o,a,r,o,.85*s);b.addColorStop(0,g),b.addColorStop(1,m),t.beginPath(),t.arc(r,o,l,0,2*Math.PI),t.fillStyle=b,t.fill(),t.beginPath();const y=Math.min(l,a);t.arc(r,o,y,0,2*Math.PI),t.fillStyle=`rgba(${c},${u},${h},0.2)`,t.fill()}),c.forEach((e,i)=>{const r=f[i],o=r*n,a=u[i];for(const s of a){const{point:a,index:l,distance:c}=s;if(c<=o+f[l]*n){const n=c/r;t.beginPath(),t.moveTo(e.x,e.y),t.lineTo(a.x,a.y),t.lineWidth=2+5*(1-n);const[o,s,l]=d[i],u=`rgba(${o},${s},${l},${1-.5*n})`;t.strokeStyle=u,t.stroke()}}})};return g(),M(()=>{m()}),{canvas:o,extent:a,nNearest:l,refreshPoints:()=>{c=Yn(re,{width:ee,height:ie},ne),g(),m()},canvas_1_binding:function(t){N[t?"unshift":"push"](()=>{e("canvas",o=t)})},slider0_value_binding:function(t){e("extent",a=t)},slider1_value_binding:function(t){e("nNearest",l=t)}}}class ae extends B{constructor(t){super(),D(this,t,oe,te,a,[])}}function se(t){var n,e,i;const r=t.$$slots.default,o=s(r,t,null);return{c(){n=p("section"),e=p("div"),o&&o.c(),b(e,"class","container svelte-1t9ulqu"),b(n,"class","svelte-1t9ulqu")},l(t){o&&o.l(div_nodes)},m(t,r){h(t,n,r),u(n,e),o&&o.m(e,null),i=!0},p(t,n){o&&o.p&&t.$$scope&&o.p(c(r,n,t,null),l(r,n,null))},i(t){i||(F(o,t),i=!0)},o(t){R(o,t),i=!1},d(t){t&&f(n),o&&o.d(t)}}}function le(t,n,e){let{$$slots:i={},$$scope:r}=n;return t.$set=(t=>{"$$scope"in t&&e("$$scope",r=t.$$scope)}),{$$slots:i,$$scope:r}}class ce extends B{constructor(t){super(),D(this,t,le,se,a,[])}}function ue(t){var n;return{c(){(n=p("span")).innerHTML='<span class="figure-number">Figure 3: </span>Adjust the slider to extend a radius outwards from each point, computed by the distance to its nth nearest neighbor. Notice that past the intersection with the first neighbor, the radius begins to get fuzzy, with subsequent connections appearing with less weight;\n\t\t\t  ',b(n,"slot","caption")},m(t,e){h(t,n,e)},d(t){t&&f(n)}}}function he(n){var e,i,r=new ae({});return{c(){r.$$.fragment.c(),e=g()},m(t,n){H(r,t,n),h(t,e,n),i=!0},p:t,i(t){i||(F(r.$$.fragment,t),i=!0)},o(t){R(r.$$.fragment,t),i=!1},d(t){L(r,t),t&&f(e)}}}function fe(t){var n,e,i,r,o,a,s,l,c,u,d,m,y,v,w,$,x,M,k,N,_,A,j=new K({props:{height:20}}),P=new X({props:{$$slots:{default:[he],caption:[ue]},$$scope:{ctx:t}}});return{c(){(n=p("h1")).textContent="A deeper dive into UMAP theory",e=g(),(i=p("p")).innerHTML='<em>Andy Coenen, Adam Pearce (<a href="https://ai.google/research/teams/brain/pair">Google PAIR</a>)</em>',r=g(),j.$$.fragment.c(),o=g(),(a=p("p")).innerHTML='The following explanation offers a rather high-level explanation of the theory behind UMAP, following up on the even simpler overview found in <a href="https://cnsviewer2.corp.google.com/cns/od-d/home/andycoenen/understanding-umap/index.html">Understanding UMAP</a>. Those interested in getting the full picture are encouraged to read UMAP\'s <a href="https://umap-learn.readthedocs.io/en/latest/how_umap_works.html">excellent documentation</a>.',s=g(),(l=p("p")).textContent="Most dimensionality reduction algorithms fit into either one of two broad categories: Matrix factorization (such as PCA) or Graph layout (such as t-SNE). At its core, UMAP is a graph layout algorithm, very similar to t-SNE, but with a number of key theoretical underpinnings that give the algorithm a more solid footing.",c=g(),(u=p("p")).textContent="In its simplest sense, the UMAP algorithm consists of two steps: construction of a graph in high dimensions followed by an optimization step to find the most similar graph in lower dimensions. In order to achieve this goal, the algorithm relies on a number of insights from algebraic topology and Riemannian geometry. Despite the intimidating mathematics, the intuitions behind the core principles are actually quite simple: UMAP essentially constructs a weighted graph from the high dimensional data, with edge strength representing how “close” a given point is to another, then projects this graph down to a lower dimensionality. The advanced mathematics gives UMAP a solid footing with which to handle the challenges of doing this in high dimensions with real data.",d=g(),(m=p("p")).innerHTML="In order to construct the initial high-dimensional graph, UMAP relies on constructing what’s known as a <strong>Čech complex</strong>, which is a way of representing a topology combinatorially (using sets rather than continuous geometry). In order to get there, we’ll use a basic building block called a <strong>simplex</strong>. Geometrically, a simplex is a k-dimensional object formed by connecting k + 1 points - for example, a 0-simplex is a point, a 1-simplex is a line, and a 2-simplex is a triangle. By thinking of our data as a set of simplices, we can capture a representation of the topology, and by combining those simplices in a specific way to form a Čech complex, we get some theoretical guarantees about how well it represents the topology.",y=g(),P.$$.fragment.c(),v=g(),(w=p("p")).innerHTML='We begin by considering each point in our data as a sample from a continuous, high-dimensional shape (our topology). We can think of each point as a 0-simplex. By extending out from each point some radius r, and connecting points that overlap, we can construct sets of 1-, 2-, and higher-dimensional simplices. This simplicial complex does a reasonable job of approximating the fundamental topology of the dataset, explained by the <a href="https://en.wikipedia.org/wiki/Nerve_of_a_covering">Nerve Theorem</a>. It turns out that the bulk of the work of representing the topology is actually being done by the 0- and 1-simplices, which constitute what\'s known as a <strong>Vietoris-Rips Complex</strong>. Most importantly, the <strong>Vietoris-Rips Complex</strong> is much easier to work with computationally, especially for large datasets. By considering just the 0- and 1-simplices, we’ve effectively just constructed a graph, which can be readily projected into a lower-dimensional analogue.',$=g(),(x=p("p")).innerHTML="Unfortunately, real-world high-dimensional data presents a problem that UMAP needs to overcome - picking the right sized radius. Too small a radius and we’ll tend towards isolated, local clusters of points. Too large, and everything becomes connected. This problem is exacerbated by the <strong>curse of dimensionality</strong>, where distances between points become increasingly similar in higher dimensions. UMAP solves this problem in a clever way: Rather than using a fixed radius, UMAP uses a variable radius determined for each point based on the distance to its kth nearest neighbor. Within this local radius, connectedness is then made “fuzzy” by making each connection a probability, with further points less likely to be connected. Since we don’t want any points to be completely isolated, a constraint is added that all points must be connected to at least its closest neighboring point. The final output of this process is a weighted graph, with edge weights representing the likelihood that two points are “connected” in our high-dimensional manifold.",M=g(),(k=p("p")).textContent="Note that since each point’s local notion of distance may be different than its neighbors’, we must resolve whether two points are connected based on potentially different directed edge weights. UMAP squares this inconsistency by computing the probability that at least one of the edges exist.",N=g(),(_=p("p")).textContent="Once the final, fuzzy simplicial complex is constructed, UMAP projects the data into lower dimensions essentially via a force-directed graph layout algorithm. This optimization step is actually very similar to t-SNE, but by jumping through the theoretical hoops while constructing our initial simplicial complex, UMAP is able to accelerate the optimization and preserve much more global structure than t-SNE.",b(n,"class","article-title")},m(t,f){h(t,n,f),h(t,e,f),h(t,i,f),h(t,r,f),H(j,t,f),h(t,o,f),h(t,a,f),h(t,s,f),h(t,l,f),h(t,c,f),h(t,u,f),h(t,d,f),h(t,m,f),h(t,y,f),H(P,t,f),h(t,v,f),h(t,w,f),h(t,$,f),h(t,x,f),h(t,M,f),h(t,k,f),h(t,N,f),h(t,_,f),A=!0},p(t,n){var e={};t.$$scope&&(e.$$scope={changed:t,ctx:n}),P.$set(e)},i(t){A||(F(j.$$.fragment,t),F(P.$$.fragment,t),A=!0)},o(t){R(j.$$.fragment,t),R(P.$$.fragment,t),A=!1},d(t){t&&(f(n),f(e),f(i),f(r)),L(j,t),t&&(f(o),f(a),f(s),f(l),f(c),f(u),f(d),f(m),f(y)),L(P,t),t&&(f(v),f(w),f($),f(x),f(M),f(k),f(N),f(_))}}}function pe(t){var e,i=[de];let r={$$slots:{default:[fe]},$$scope:{ctx:t}};for(var o=0;o<i.length;o+=1)r=n(r,i[o]);var a=new ce({props:r});return{c(){a.$$.fragment.c()},m(t,n){H(a,t,n),e=!0},p(t,n){var e,r=t._metadata?function(t,n){const e={},i={},r={$$scope:1};let o=t.length;for(;o--;){const a=t[o],s=n[o];if(s){for(const t in a)t in s||(i[t]=1);for(const t in s)r[t]||(e[t]=s[t],r[t]=1);t[o]=s}else for(const t in a)r[t]=1}for(const t in i)t in e||(e[t]=void 0);return e}(i,[(e=de,"object"==typeof e&&null!==e?e:{})]):{};t.$$scope&&(r.$$scope={changed:t,ctx:n}),a.$set(r)},i(t){e||(F(a.$$.fragment,t),e=!0)},o(t){R(a.$$.fragment,t),e=!1},d(t){L(a,t)}}}const de={title:"A deeper dive into UMAP theory",layout:"./Layout.svelte"};return new class extends B{constructor(t){super(),D(this,t,null,pe,a,[])}}({target:document.body})}();
//# sourceMappingURL=bundle-supplement.js.map
